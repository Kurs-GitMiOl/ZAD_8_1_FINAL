# Zad 8.1 Iris ML API

## 1. Project description

This system is a simple AI service shared as a FastAPI web service.
The system uses a previously trained classification model
That system helps identify the species of an Iris flower.
By providing measurements of the flower’s sepals and petals, users can quickly get a prediction of its species.  
It solves the problem of classifying Iris flowers based on features,
making it easy to analyze and understand data from the Iris dataset.


## 2. Used model
- Type: SVM Classifier (Support Vector Machine
- Pipeline: 
StandardScaler() – scales the input features 
SVC(kernel='linear', probability=True) – linear SVM classifier with probability output
- Library: scikit-learn

### Input
The model pipeline expects four features:  
- sepal_length – length of the sepal  
- sepal_width – width of the sepal  
- petal_length – length of the petal  
- petal_width – width of the petal  

### Output
- Generated by model methods: 
  - `predict(features)` → `prediction_class` (int) – numeric class  
  - `predict_proba(features)` → probabilities for each class (float)  
- Added by the API endpoints:  
  - `prediction_name` (string) – human-readable class name mapped from `prediction_class` (e.g., "setosa", "versicolor", "virginica")  


## 2. Input Data from dataset
Features:
- sepal_length – float
- sepal_width – float
- petal_length – float
- petal_width – float

Example input JSON:

{
  "sepal_length": 5.0,
  "sepal_width": 3.0,
  "petal_length": 2.4,
  "petal_width": 0.3
}

## 3. Used technologies
- Python 3.10+
- scikit-learn
- FastAPI
- uv (environment and dependency management)
- Git

## 4. Installation and run

- open the terminal and go to the project folder
- create a virtual environment: python -m venv .venv
- activate it: .venv\Scripts\activate or macOS\Linux source .venv/bin/activate
- install dependencies: uv sync
- start the FastAPI server: uvicorn app.main:app --reload
- the API will be available at: http://127.0.0.1:8000
- open the API documentation at: http://127.0.0.1:8000/docs
- choose endpoint, next choose Try it out, then choose execute
- alternative documentation is available at: http://127.0.0.1:8000/redoc
- to stop server us CTRL + C
- 
- ### Restarting the API
- open the terminal and go to the project folder
- activate it: .venv\Scripts\activate or on macOS\Linux source .venv/bin/activate
- start the FastAPI server: uvicorn app.main:app --reload
- the API will be available at: http://127.0.0.1:8000
- open the API documentation at: http://127.0.0.1:8000/docs
- choose endpoint, next choose Try it out, then choose Execute
- alternative documentation is available at: http://127.0.0.1:8000/redoc
- to stop server us CTRL + C

## 5. Requirements
- Python 3.10+
- uv

## 6. Endpoints description and examples

## - Endpoint `/predict`

    Prediction endpoint for iris flower classification.
    It takes flower features in JSON format, predicts the flower class,
    and returns both the class number and the class name.

### Example JSON requests to /predict
1. Setosa

Request:
{
  "sepal_length": 5.0,
  "sepal_width": 3.4,
  "petal_length": 1.5,
  "petal_width": 0.2
}

Response:
{
  "prediction_class": 0,
  "prediction_name": "setosa"
}


2. Versicolor

Request:
{
  "sepal_length": 6.0,
  "sepal_width": 2.7,
  "petal_length": 4.5,
  "petal_width": 1.5
}

Response:
{
  "prediction_class": 1,
  "prediction_name": "versicolor"
}


3. Virginica

Request:
{
  "sepal_length": 6.5,
  "sepal_width": 3.0,
  "petal_length": 5.2,
  "petal_width": 2.0
}

Response:
{
  "prediction_class": 2,
  "prediction_name": "virginica"
}

## - Endpoint `/predict_is_setosa`

    Prediction endpoint that checks if the iris flower is Setosa.
    It takes flower features in JSON format and returns True if the predicted class is Setosa,
    otherwise False.

### Example JSON requests to `/predict_is_setosa`
Request:
{
  "sepal_length": 5.1,
  "sepal_width": 3.5,
  "petal_length": 1.4,
  "petal_width": 0.2
}

Response:
{
  "is_setosa": true
}

## - Endpoint `/describe_input` 

    Endpoint that describes iris flower features.
    It takes flower features in JSON, calculates the minimum, maximum, and mean values, and returns them.


### Example JSON requests to `/describe_input`
1. Example

Request:
{
  "sepal_length": 5.1,
  "sepal_width": 3.5,
  "petal_length": 1.4,
  "petal_width": 0.2
}

Response:
{
  "min": 0.2,
  "max": 5.1,
  "mean": 2.55
}

2. Example

Request:
{
  "sepal_length": 6.0,
  "sepal_width": 2.8,
  "petal_length": 4.5,
  "petal_width": 1.5
}

Response:
{
  "min": 1.5,
  "max": 6.0,
  "mean": 3.7
}

## - Endpoint `/predict_proba`

    Return prediction probabilities for each Iris flower class.
    The endpoint takes flower features and returns a probability for each class.
    Probabilities are rounded to 3 decimal places.

### Example JSON requests to `/predict_proba`
1. Example

Request:
{
  "sepal_length": 5.9,
  "sepal_width": 3.0,
  "petal_length": 4.2,
  "petal_width": 1.5
}

Response:
{
  "setosa": 0.01,
  "versicolor": 0.97,
  "virginica": 0.02
}

2. Example

Request:
{
  "sepal_length": 6.5,
  "sepal_width": 3.0,
  "petal_length": 5.2,
  "petal_width": 2.0
}

Response:
{
  "setosa": 0.012,
  "versicolor": 0.076,
  "virginica": 0.911
}


## - Endpoint `/describe_input_get`

    Describe Iris input values using query parameters.
    The endpoint returns min, max, and mean values of the input features.

### Example requests to  `/describe_input_get`
1. Example

http://127.0.0.1:8000/describe_input_get?sepal_length=6.0&sepal_width=2.8&petal_length=4.5&petal_width=1.5

Use the link above or write input values from link into field Description in: http://127.0.0.1:8000/docs

Response:
{
  "min": 1.5,
  "max": 6,
  "mean": 3.7
}
2. Example

http://127.0.0.1:8000/describe_input_get?sepal_length=5.4&sepal_width=3.2&petal_length=1.6&petal_width=0.4

Use the link above or write input values from link into field Description in: http://127.0.0.1:8000/docs

Response:
{
  "min": 0.4,
  "max": 5.4,
  "mean": 2.65
}

## - Endpoint `/model_info`

    Returns basic information about the used machine learning model.
    It shows model type, kernel type, and probability setting.

Response:

{
  "model_type": "SVC",
  "kernel": "linear",
  "probability": true
}

## - Endpoint `/status`

    Simple endpoint to check if the API is running.
    It returns basic status information.

Response:
{
  "status": "ok"
}

## 7.  Tests
This project includes basic tests for all main endpoints of application.
The tests are written using pytest and FastAPI’s TestClient.

- POST /predict – checks prediction_class and prediction_name
- POST /predict_is_satosa - if the predicted class is setosa, it returns true, otherwise, it returns false
- POST /predict_missing_field – tests the /predict endpoint when a required field is missing.
- POST /predict_edge_case – test with minimum and maximum Iris feature values
- POST /predict_proba – checks probabilities for each class and that they sum to ~1
- POST /describe_input – checks min, max, mean values.
- POST /describe_input_invalid – sends wrong data and checks the API returns 422 error
- GET /describe_input_get – checks min, max, mean values from query parameters
- GET /model_info – checks model type, kernel type, and probability configuration
- GET /status – checks API health and verifies response contains status ok


How to run tests:
- Install dependencies including pytest: pip install pytest
- Run all tests: pytest